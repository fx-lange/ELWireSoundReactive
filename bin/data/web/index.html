<html lang="en">
<head>
 	<meta charset=utf-8 />
 	<title>ofxLibwebsockets Echo Server test app</title>
	<link rel="stylesheet" href="css/reset.css" type="text/css" media="screen" charset="utf-8" />
	 <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" /> 
     <script type="text/javascript" src="js/libs/jquery-1.7.1.min.js"></script>
 	<script type="text/javascript" src="js/utils.js"></script>
 	<script type="text/javascript" src="js/main.js"></script>
 	
</head>
<body>
<script src="dat.gui.min.js" type="text/javascript"></script>
<script src="dat.color.min.js" type="text/javascript"></script>
<script src="guiGlue.js" type="text/javascript"></script>
<script src="paramsGUI.js" type="text/javascript"></script>

<script>
	var optionsGUI = {};// ? {width: 500};
	var params;
	var valsLastFrame;

	var msg = {
	    
	    var2 : {
	        
	        value : 1,
	        min : 0,
	        max : 1,
	        step : 0.01
	       
	    }
	};



// 	var params = {
//   var1 : 'a',
//   var2 : 1
// }

// window.onload = function() {
//   var gui = new dat.GUI();
//   gui.add(params, "var1", 1,2);
//   gui.add(params, 'var2', 0, 1).step(0.01);
// }
$(document).ready( function() {
	setupSocket();
	
	setTimeout(function(){
		var myJson = {type:"initRequest"};	
		socket.send(JSON.stringify(myJson));
	}, 3000);
});
	
	function initGui( val ){


		console.log("initing gui:");
		console.log(val);
		obj = JSON.parse(val);
		//console.log(val);
		console.log(obj);
		if(obj["type"]=="update"){
			console.log("Update");
			var param = params;
			for(i=0;i<obj["path"].length;++i){
				param = param[obj["path"][i]];
			}
			console.log(param);
			param[obj["name"]] = obj["value"];
		}else{
			params = guiGlue(obj, optionsGUI);
		}
	};

	

		//initGui(msg);
	// window.onload = function(){
	//     initGui(msg);
	// };


	// var params = guiGlue(obj, optionsGUI);
	// var jsonString = JSON.stringify(paramsGUI, 4);
	// console.log(jsonString);
	
	function valsChanged(){
		console.log(JSON.stringify(params));

		if(typeof app === 'undefined'){
				; // maybe we are testing this locally ?
			} else {
				//sendStringToOF("params", JSON.stringify(params))
			}
		
		//valsLastFrame = JSON.parse(JSON.stringify(params)); // make a copy
	}
	</script>

 <body>
	<div id="container">
		<h2>ofxLibwebsockets test applet</h2><hr />
		<div>
			<h3>Browser info</h3><hr />
			<div class="info">
				<strong>Detected Browser: <div id="brow">...</div></strong><br />
				<div id="status">Not initialized</div><br />
			</div>
		</div>
		<div>
			<h3>Input</h3>
			<hr />
			<input id="message" type="text" />
			<input id="button" type="button" value="send" />
		</div>
		<div>
			<h3>Messages</h3>
			<hr />
			<div id="messages" class="info"></div>
		</div>
	</div>
</body>
</html> 
